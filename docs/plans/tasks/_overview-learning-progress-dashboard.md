# 全体設計書: Learning Progress Dashboard

生成日時: 2025-08-05
対象計画書: learning-progress-dashboard.md

## プロジェクトの全体像

### 目的とゴール
学習進捗を可視化し、学習者のモチベーション向上と効率的な学習支援を実現するダッシュボード機能の実装。リアルタイム更新とモバイル最適化により、現代的な学習体験を提供する。

### 背景とコンテキスト
組み込みシステムスペシャリスト試験対策システムにおいて、学習者が自身の進捗を把握し、適切な学習計画を立てられるよう支援する必要性から、包括的なダッシュボード機能が求められている。

## タスク分割の設計

### 分割方針
1. **層別分割**: データベース → API → フロントエンド → 統合
2. **機能別分割**: 各UI コンポーネントを独立して実装
3. **依存関係の最小化**: 各タスクが可能な限り独立して実行可能
4. **アトミックコミット**: 1タスク = 1コミット = 1論理的変更

### タスク間の関連マップ
```
Phase 1: データ基盤・コアAPI (4タスク)
├── LPD-001: データベーススキーマ拡張
│   ↓ (スキーマを提供)
├── LPD-002: コアAPI エンドポイント
│   ↓ (APIを提供)
├── LPD-003: クエリ最適化
│   └── LPD-004: WebSocket インフラ (並列)

Phase 2: フロントエンド基盤・状態管理 (3タスク)
├── LPD-005: ダッシュボード状態管理 (独立)
├── LPD-006: API クライアント統合 (LPD-002, LPD-005依存)
└── LPD-007: WebSocket クライアント (LPD-004, LPD-005依存)

Phase 3: コアUI コンポーネント (4タスク)
├── LPD-008: ダッシュボードページレイアウト (LPD-005, LPD-006依存)
│   ↓ (レイアウト基盤を提供)
├── LPD-009: 概要統計カード (LPD-008依存)
│   ↓ (基本UIパターンを提供)
├── LPD-010: インタラクティブトレンドチャート (LPD-009依存)
│   ↓ (チャートパターンを提供)
└── LPD-011: 分野別ヒートマップ (LPD-010依存)

Phase 4: 高度機能・統合 (4タスク)
├── LPD-012: 達成記録システムUI (LPD-011依存)
│   ↓ (UI完成度を提供)
├── LPD-013: 学習目標管理 (LPD-012依存)
│   ↓ (機能完成度を提供)
├── LPD-014: モバイル最適化 (全コンポーネント依存)
│   ↓ (最適化済みUIを提供)
└── LPD-015:統合テスト・バグ修正 (全タスク依存)
```

### 共通化ポイント
- **APIクライアントパターン**: LPD-006で確立したパターンを他のタスクで再利用
- **状態管理パターン**: LPD-005で確立したZustandパターンを全体で統一
- **UIコンポーネントパターン**: LPD-009で確立したカードレイアウトを後続で活用
- **チャートライブラリ**: Material-UI X-Chartsの使用方法をLPD-010で確立し、LPD-011で再利用
- **モバイル最適化手法**: LPD-014で全コンポーネントに一括適用

## 実装時の注意事項

### 全体を通じて守るべき原則
1. **モバイルファースト**: 全UIコンポーネントでモバイル320px以上対応
2. **パフォーマンス優先**: ダッシュボード読み込み2秒以内、チャート描画200ms以内
3. **アクセシビリティ**: WCAG AA準拠、スクリーンリーダー対応
4. **リアルタイム対応**: WebSocket接続の安定性と効率的な更新
5. **TypeScript厳格モード**: 型安全性の確保

### リスクと対策
- **リスク**: WebSocket接続の不安定性
  **対策**: ポーリング・フォールバック機能の実装、自動再接続機能
- **リスク**: モバイルでのパフォーマンス劣化
  **対策**: データサンプリング、遅延ローディング、キャッシュ活用
- **リスク**: データベースクエリの性能低下
  **対策**: 生SQL使用、適切なインデックス、結果キャッシュ

### 影響範囲の管理
- **変更が許可される範囲**: 
  - `backend/src/controllers/dashboardController.ts` - 新規作成
  - `backend/src/routes/dashboardRoutes.ts` - 新規作成  
  - `backend/prisma/schema.prisma` - Dashboard関連モデル追加のみ
  - `frontend/src/components/dashboard/` - 新規ディレクトリ
  - `frontend/src/stores/useDashboardStore.ts` - 新規作成
  - `frontend/src/pages/DashboardPage.tsx` - 新規作成

- **変更禁止エリア**:
  - 既存の練習・試験機能の実装
  - 認証・ユーザー管理機能
  - 基本的なルーティング設定
  - データベースの既存テーブル構造

### 品質保証方針
- **各フェーズ完了時**: そのフェーズのタスクが全て完了し、依存関係が正しく機能することを確認
- **統合テスト**: LPD-015で全機能の連携動作を包括的にテスト
- **パフォーマンステスト**: 各UIコンポーネントのレスポンス時間とメモリ使用量を測定
- **モバイルテスト**: 実機での動作確認、タッチ操作の快適性検証

### 成功基準
- **技術的成功**: 全quality gatesをパス、パフォーマンス目標達成
- **ユーザー体験成功**: モバイル・デスクトップでの快適な操作性
- **ビジネス影響成功**: 学習継続率の向上、ユーザー満足度4.0/5.0以上

---

## 実行推奨順序

### 週1 (Phase 1-2): データ基盤とフロントエンド基盤
1. LPD-001 → LPD-002 → LPD-003 (シーケンシャル実行)
2. LPD-004 (LPD-002完了後、並列実行可能)
3. LPD-005 (独立実行可能)
4. LPD-006 → LPD-007 (LPD-005完了後)

### 週2 (Phase 3-4): UI実装と統合
5. LPD-008 → LPD-009 → LPD-010 → LPD-011 (シーケンシャル実行)
6. LPD-012 → LPD-013 (シーケンシャル実行)
7. LPD-014 (全UI完了後)
8. LPD-015 (最終統合テスト)

このスケジュールにより、依存関係を適切に管理しながら効率的な開発が可能になります。